---
title: "Açık Yönetişim Verisi (Open Government Data) Uygulamaları ve İzmir’de Yerel Fiyatlar"
author: "Firat Gundem"
date: "3/20/2022"
output:
  html_document: default
  pdf_document: default
  word_document: default
knit: (function(input_file, encoding) {
  out_dir <- 'docs';
  rmarkdown::render(input_file,
 encoding=encoding,
 output_file=file.path(dirname(input_file), out_dir, 'index.html'))})
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE) 
```


```{r message=FALSE, warning=FALSE}
library(dplyr)
library(tidyverse)
library(ggplot2)
library(XML)
library(rjson)
library(jsonlite)
library(readr)
library(tm)
library(lubridate)
library(plotly)
library(htmlwidgets)
library(readxl)
```

# Açık Yönetişim Verisi (Open Government Data)

Bu kısa bilgi notunda sizlere ülkemizdeki yerel yönetimleri de ilgilendiren Açık Yönetişim Verisi (Open Government Data, OGD) politikalarından ve uygulamalarından bahsedeceğim. Açık Yönetişim Verisi uygulamaları ABD Başkanı Barack Obama'nin 2009 yılında, Beyaz Ev'de geçirdiği ilk gününde imzaladığı Şeffaflık ve Açık Yönetişim Yasasına (Memorandum on Transparency and Open Government) dayanmaktadır. Şeffaflık, kamusal katilim ve işbirliği gibi kavramlar üzerine yükselen Açık Yönetişim Verisi yasası kısaca daha önce görülmemiş boyutlarda verinin (data) kişisel bilgilerden arındırılarak yurttaşların erişimine açılması olarak özetlenebilir. Açık Yönetişim Verisi uygulamalarının arkasında yatan mantık söz konusu verilerin, yurttaşlar ile yerel ve genel kamu otoriteleri arasında karşılıklı iletişimi kuvvetlendirmesi ve otoritelerin uyguladıkları politikalarda veri aracılığıyla yurttaş katılımının artırılmasıdır. Tabi beklenen etkinin ortaya çıkması için verinin nasıl paylaşılacağı önemlidir. Açık Yönetişim Verisi uygulamalarının başarıya ulaşabilmesi için verilerin bazı özellikleri taşıması gerekmektedir. 2009 yılında Açık Yönetişim Çalışma Grubu'na göre Açık Veri aşağıdaki özellikleri taşımalı:

#### 1- Tam olmalı (complete);
#### 2- Öncelikli/Temel olmalı (primary);
#### 3- Güncel olmalı (timely);
#### 4- Erişilebilir olmalı (accesible);
#### 5- Makineler (bilgisayar vb.) tarafından işlenebilir olmalı (machine-processable);
#### 6- Ayrımcı nitelikte olmamalı (non-discriminatory);
#### 7- Telif ile korunmamalı, patentsiz olmalı (non-proprietary);
#### 8- Lisanssız (bedava) olmalı (licence-free);
 
Amerika'daki Açık Yönetişim Verisi uygulamaları kısa surede dünya çapında yaygınlık kazandı. Hem ulusal hem de yerel bazda kamu otoriteleri Açık Veri Portalları (Open Data Portal) aracılığıyla aklınıza gelebilecek pek çok veriyi kamuya açtılar. Söz konusu uygulamaların dünya çapındaki yayılımını görmek için aşağıdaki harita bir fikir vermektedir.

![Sekil 1: Dunyada Acik Yonetisim Verisi](C:/Users/firat/Desktop/Izmir_fiyatlar/figure1.png)

Bununla beraber Açık Yönetişim Verisi uygulamalarından beklenen etkinin ortaya çıkabilmesi için paylaşılan verinin formatı önemli. Yukarıda da bahsedilen 4., 7., ve 8. maddeler veri formatının taşıması gereken özellikleri özetliyor. Bu çerçevede indirilen verinin tamamen lisans gerektirmeyen yazılımlar (Python, R, UnixShell, vb.) aracılığıyla işlenebilir olması gerekiyor. Sekil 2 ABD'de Açık Yönetişim Verisi uygulamaları bağlamında paylaşılan verilerin formatlarına dair bizlere bir fikir veriyor.

![Sekil 2: Acik Yonetisim Veri Formatlari](C:/Users/firat/Desktop/Izmir_fiyatlar/figure2.png)

Şekil 2'den de görüldüğü gibi OGD kapsamında paylaşılan verilerin büyük çoğunluğunu .csv, .json, .xml gibi lisans gerektirmeyen, bedava (free) formatlar oluşturuyor. Bu görsel, OGD'den beklenen etkinin ortaya çıkması için gösterilen özene bir kanıt sunuyor. Bugün gerek ABD'de, gerekse de Avrupa'da OGD uygulamaları neticesinde yurttaşlar, üniversiteler ve yerel ve kamu otoritelerinin işbirliğine dayalı pek çok gelişme yaşanıyor. Bu gelişmeler kentsel sorunlar için açık veriye dayalı çözümlerden yurttaşlar tarafından geliştirilen veri bazlı uygulamaların açık veri partallarında paylaşılmasına, açık verilerin üniversiteler tarafından Büyük Veri (Big Data) ve Makine Öğrenmesi (Machine Learning) uygulamaları için kullanılmasına kadar geniş bir alana yayılıyor. Dolayısıyla OGD uygulamaları veri bazlı politika ve veri bilimi açısından geniş bir potansiyeli bünyesinde barındırıyor.

# Türkiye’de Açık Yönetişim Verisi ve Uygulamaları

Türkiye’de de cılız sayılabilecek bazı OGD uygulamalarından bahsetmek mümkün. Cumhurbaşkanlığı bünyesinde kurulan Dijital Dönüşüm Ofisi Açık Veri politikalarının Türkiye’deki uygulamasından sorumlu. Öte yandan Dijital Dönüşüm Ofisi'nin web sayfasında kısa açıklamalar dışında uzun suredir herhangi bir yeni içerik paylaşımı yapılmış değil.

Bununla beraber bazı büyükşehir belediyeleri OGD uygulamaları kapsamında online Açık Veri Portalları oluşturmuş durumdalar. İstanbul, İzmir, Konya, Balikesir, Bursa Büyükşehir Belediyeleri birer Açık Veri Portalına sahipler. Bu kısa bilgi notunda da İzmir Büyükşehir Belediyesi'nin Açık Veri Portalı’nda paylaştığı bazı veri setlerini inceleyecek ve söz konusu verilerden hareketle ulusal ekonomiye ve fiyat hareketlerine dair bazı veri görselleştirmelerinde bulunacağız. Böylelikle Açık Veri uygulamalarının ve Açık Veri Portallarının ne kadar önemli olabileceği konusunda bir fikir edineceğiz.

# İzmir Büyükşehir Belediyesi Açık Veri Portali

İzmir Büyükşehir Belediyesi [Açık Veri Portalı](https://acikveri.bizizmir.com/tr/)
Ocak 2021'den beri faaliyette ve çeşitli baslıklarda yerelden üretilmiş verileri İzmirlilerin hizmetine sunuyor. Aşağıdaki sekil İzmir Açık Veri Portalı’nda yayınlanan veri başlıkları ve veri miktarını görselleştiriyor.

![Sekil 3: Izmir BSB Acik Veri Portali](C:/Users/firat/Desktop/Izmir_fiyatlar/figure3.png)

İzmir BSB Ekonomi başlığı altında çok kıymetli ve detaylı 2 veri seti yayınlıyor. Bunlardan ilki [Balık Hal Fiyatları](https://acikveri.bizizmir.com/tr/dataset/balik-hal-fiyatlari), diğeri de [Sebze ve Meyve Hal Fiyatları](https://acikveri.bizizmir.com/tr/dataset/sebze-ve-meyve-hal-fiyatlari). Her iki veri seti de gerek kapsamı (176 çeşit sebze ve meyve, 152 çeşit balık fiyatı), gerek frekansı (günlük), gerekse de tarih aralığı (2006'dan günümüze) ile ekonomistlerin ilgisini çeken çok önemli veri setleri. Balık Hal fiyatları 2007 yılından başlayarak günümüze kadar gelen günlük bir veri seti. İzmir’de tüketilen her bir Balık turunun fiyatı ve dahil oldukları gruplar (Balık, İthal (Donuk), Kültür, Tatlı Su) günlük olarak veri setinde yer almakta. Yine Sebze ve Meyve Hal Fiyatları verisi de İzmir’de Sebze ve Meyve haline gelen bütün sebze ve meyvelerin günlük fiyatlarını ve dahil oldukları grupları (Sebze, Meyve ve İthal) içermekte. Her iki veri seti de İzmir’deki Sebze, Meyve ve Balık fiyatlarının uzun dönemli gelişimleri hakkında önemli fikirler veriyor. 

Burada çok da fazla kodlama vb. gibi detaylara girmeden söz konusu veri setleri ile yapılan interaktif veri görselleştirmelerini sizlerle paylaşmak istiyorum. Veri görselleştirmede kullanılan Balık Hal Fiyatları verisi yaklaşık 292 bin, Sebze ve Meyve Hal Fiyatları verisi de yaklaşık 363 bin gözlem içermekte. Söz konusu günlük verileri isim ve türlerine göre ay bazında toplulaştırarak 2006 yılından itibaren ortalama fiyat değişimlerini görselleştirelim.

Önce Sebze ve Meyve fiyatları ile başlayalım.



```{r warning=FALSE, echo=TRUE, message=FALSE, include=FALSE}
df_merged <- read.csv("C:/Users/firat/Desktop/Izmir BSB/izmir/df_merged.csv")
```


```{r include=FALSE}
df_merged_a <- read.csv2("C:/Users/firat/Desktop/Izmir_fiyatlar/local_prices/df_merged_a.csv", sep = ",")
df_merged_c <- read.csv2("C:/Users/firat/Desktop/Izmir_fiyatlar/local_prices/df_merged_c.csv", sep = ",")

```




```{r include=FALSE}
df_merged_d <- df_merged %>% group_by(MAL_TURU, year, month)%>% summarize(m = mean(ORTALAMA_UCRET, na.rm = TRUE))
```


```{r include=FALSE}
df_merged_a$m <- as.numeric(as.character(df_merged_a$m))
df_merged_c$m <- as.numeric(as.character(df_merged_c$m))
df_merged_d$m <- as.numeric(as.character(df_merged_d$m))
df_merged_d$year <- as.numeric(as.integer(df_merged_d$year))
df_merged_d$month <- as.numeric(as.integer(df_merged_d$month))
```

```{r message=FALSE, warning=FALSE, include=FALSE}
x1 <- plot_ly(df_merged_a, x = ~year, y = ~m) %>%
 # add_lines(color = ~ordered(MAL_ADI)) %>% 
  add_lines(linetype = ~MAL_ADI)
saveWidget(x1, "x1.html", selfcontained = F, libdir = "lib")
```


```{r message=FALSE, warning=FALSE, include=FALSE}
x2 <- plot_ly(df_merged_c, x = ~year, y = ~m) %>%
  add_lines(color = ~ordered(MAL_TURU)) 
saveWidget(x2, "x2.html", selfcontained = F, libdir = "lib")

```


```{r message=FALSE, warning=FALSE, include=FALSE}

x3 <- plot_ly(df_merged_d, x = ~month, y = ~m) %>%
  add_lines(color = ~ordered(year))
saveWidget(x3, "x3.html", selfcontained = F, libdir = "lib")


x3
```


```{r message=FALSE, warning=FALSE}
x1
x2
x3

```

Yukarıdaki x1 grafiği 176 çeşit farklı sebze ve meyve turunun fiyatlarındaki yıllık ortalamaları gösteren çok zengin bir veri görselleştirmesidir. Grafik interaktif oluşturulduğu için tek tek (istediğiniz ürünün üzerine gelerek mouse ile çift tıklayarak ekleme yapabilirsiniz), grup halinde (çift tıkladıktan sonra tek tek istediğiniz ürünleri ekleyerek gruplandırabilirsiniz), ya da topluca (tekrar çift tıklayarak) istenilen sebze ve meyve turunun görselleştirilmesi mümkündür. Bütün sebze ve meyve fiyatlarındaki yükseliş kolayca gözlenmektedir.

x2 grafiği ise x1'deki sebze ve meyvelerin "Sebze", "Meyve" ve "Ithal" grupları altında, daha toplulaştırılmış bir görselleştirmesini sunmaktadır. Böylelikle hangi mal grubunda fiyat artışları birbirini takip ediyor, hangi mal grubu ayrışıyor, bunu görsel olarak tespit etmek mümkün olmaktadır. Şekilden de görüldüğü gibi İthal sebze ve meyve fiyatlarındaki yukarı gidiş, yerlilerden bir hayli fazla.

x3 grafiği ise daha farklı bir görselleştirme sunuyor. Yıl içindeki sebze ve meyve gruplarındaki fiyat dalgalanmaları ay detayında görselleştirilmiş durumda. Üstelik farklı yıllar aynı anda seçilerek yıllar arası anında karşılaştırma yapma imkân sunmakta. Buna göre İzmir’de 2006'dan 2022'ye meyve fiyatları 6 kat, sebze fiyatları 5.3 kat, ithal sebze ve meyve fiyatları ise 4.8 kat artmış görünüyor. 


Ayni görselleştirmeyi Balık Hal fiyatları için de yapalım.


```{r warning=FALSE, echo=TRUE, message=FALSE, include=FALSE}
df_fish <- read.csv("C:/Users/firat/Desktop/fish_prices/df_fish.csv")
```

```{r warning=FALSE, echo=TRUE, message=FALSE, include=FALSE}
df_fish_a <- df_fish %>% group_by(MAL_ADI, year)%>% summarize(m = mean(ORTALAMA_UCRET)) #Mal Adi'na gore gruplandirilip ortalamasi alinmis fiyakar

df_fish_b <- df_fish %>% group_by(MAL_ADI, year) %>% filter(MAL_ADI =="AHTAPOT(DONUK)") %>% summarize(m = mean(ORTALAMA_UCRET))

df_fish_c <- df_fish%>% group_by(MAL_TURU, year)%>% summarize(m = mean(ORTALAMA_UCRET, na.rm = TRUE))

df_fish_d <- df_fish %>% group_by(MAL_TURU, year, month)%>% summarize(m = mean(ORTALAMA_UCRET, na.rm = TRUE))

```

```{r include=FALSE}
df_fish_a
df_fish_b
df_fish_c
df_fish_d
```

```{r message= FALSE, echo= FALSE, warning= FALSE, include=FALSE}
f3 <- plot_ly(df_fish_d, x = ~month, y = ~m) %>%
  add_lines(color = ~ordered(year))
saveWidget(f3, "f3.html", selfcontained = F, libdir = "lib")
```


```{r message= FALSE, echo= FALSE, warning= FALSE, include=FALSE}
f2 <- plot_ly(df_fish_c, x = ~year, y = ~m) %>%
  add_lines(color = ~ordered(MAL_TURU)) 
saveWidget(f2, "f2.html", selfcontained = F, libdir = "lib")

```


```{r message= FALSE, echo= FALSE, warning= FALSE, include=FALSE}
f1 <- plot_ly(df_fish_a, x = ~year, y = ~m) %>%
 # add_lines(color = ~ordered(MAL_ADI)) %>% 
  add_lines(linetype = ~MAL_ADI)
saveWidget(f1, "f1.html", selfcontained = F, libdir = "lib")
```

Aşağıdaki grafik de x1'e benzer şekilde İzmir Balık Hali'ndeki her çeşit deniz canlısının yıllık ortalama fiyatlarını tek tek, grup olarak ya da topluca görselleştiriyor. Şekilden de görüldüğü gibi balık fiyatlarındaki artış 2018'den sonra hız kazanıyor. Peki bu fiyatları Tatlı Su, Kültür, İthal ve Balık (=deniz) olarak gruplandırsak nasıl bir şekille karşılaşırız? Aşağıdaki f2 grafiği de bu gruplandırmaya göre ortalama balık fiyatlarını gösteriyor.

```{r message= FALSE, warning= FALSE}
f1

```


f2 sekline göre 2016'ya kadar nispeten yatay seyreden balık fiyatları 2016'dan sonra topluca ivme kazanıyor. Burada özel olarak belli bir grubun diğerlerinden ayrıştığını söyleyemiyoruz. Söz konusu artış topluca gerçekleşmiş. Sebze ve Meyve fiyatlarının tersine Balık fiyatlarında İthal (Donuk) balık grubunun Deniz ve Kültür balıklarında yaşanan fiyat artışlarının altında kaldığı göze çarpıyor. Ve son olarak da yıllar arası karşılaştırma yapabilmek için f3 sekline göz atalım.

```{r}
f2
```

```{r}
f3
```

f3'e bakıldığında fiyatlar arasındaki farkların yıllar geçtikçe açıldığı gözlenmekte. Ayrıca Balık fiyatları Sebze ve Meyve fiyatlarıyla karşılaştırılmayacak ölçüde, yaklaşık 50-60 katlık bir artış yaşamış 2007'den 2022'ye. Bu grafik ile bunu gözlemlemek oldukça mümkün.

Bütün grafikler interaktif olarak görselleştirilmiş durumda. Legendlardan istenilen manipülasyonlar yapılabilmekte, hover ile veri etiketleri görülebilmekte, istenilen donemin verilerine zoom yapılabilmekte ve istenirse grafikler manipülasyonlu ya da manipülasyonsuz olarak .png formatında indirilebilmektedir. 

Söz konusu veriler pek çok açıdan önemlidir. İlk olarak veriler, Türkiye’de nadir bulunan Açık Yönetişim Verilerine İzmir’den bir örnek teşkil etmektedir. Veriler, İzmir Büyükşehir Belediyesi Veri Portalı’ndan serbestçe indirilebilmekte, herhangi bir lisans gerektirmeyen yazılımlarla manipüle edilebilmekte ve görselleştirilebilmektedir. Ayrıca söz konusu veri, son günlerde Türkiye’de çokça konuşulan fiyat artışlarındaki seyre dair İzmir yerelinden örnekler sunmaktadır. Bu verilerin TUIK'in İzmir için ilan ettiği gıda fiyat artışlarıyla karşılaştırılması son günlerde çokça tartışılan enflasyondaki seyre dair İzmir yerelinden yeni bir şeyler söyleyebilir.


```{r message= FALSE, echo= FALSE, warning= FALSE, include=FALSE}
 indexes <- read_excel("indexes.xlsx")
# indexes
```




```{r message= FALSE, echo= FALSE, warning= FALSE, include=FALSE}
p4 <- plot_ly(
  data = indexes,
  x = ~year,
  y = ~TUIK_GIDA, 
  name = "TUIK_GIDA",
  type = "scatter",
  mode = "lines",
  line = list(width = 2, 
              dash = "solid",
              color = "green")) %>% 
  add_trace(y = ~BALIK, name = "BALIK", mode = "lines", line = list(width = 4, dash = "dash", color = "gray"))%>% 
  add_trace(y = ~SEBZE_MEYVE, name = "SEBZE_MEYVE", mode = "lines+markers", line = list(dash = "dot", color = "red"))
saveWidget(p4, "p4.html", selfcontained = F, libdir = "lib")

```

P4 grafiği İzmir’deki sebze, meyve ve balık hal fiyatları ile TUIK'in İzmir için yayınladığı gıda fiyatlarını 2007=100 baz alarak görselleştiriyor.

```{r}
p4
```



P4'e göre TUIK'in İzmir’e dair yayınladığı Gıda Fiyatlarında meydana gelen artış ortalama Sebze ve Meyve hal fiyatlarındaki artıştan büyük, Balık hal fiyatlarındaki artıştan ise küçüktür. TUIK Gıda Fiyatlarının Balık Hal fiyatları ile 2020 yılına kadar paralel gittiği, fakat 2020'den sonra ikisi arasındaki farkın giderek açıldığı gözlenmekte. 2007 = 100 baza göre İzmir için TUIK Gıda fiyatları 7.8 kat, balık hal fiyatları ise 9.7 kat artmış görünüyor. Bütün fiyat görselleştirmelerinde 2020'den sonraki bozulma dikkat çekici.  

Bu kısa uygulama yazısında hem OGD anlatılmış hem de İzmir Büyükşehir Belediyesinin Açık Veri Portalı’ndan alınan verilerle OGD'nin enflasyon gibi hayati bir konuda nasıl önemli bir veri kaynağı olabileceği gösterilmiştir. Kuskusuz OGD uygulamalarının Türkiye çapında yaygınlık kazanması, yerel veri kaynaklarının artmasına ve yurttaşların veri okur yazarlığına katkıda bulunacaktır.

<br>
<br>
<br>






